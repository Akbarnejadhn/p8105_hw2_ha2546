---
title: "p8105_hw2_ha2546"
author: "Hana Akbarnejad"
date: "9/27/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
```

```{r Mr.Trash Wheel}

library(readxl)

trash_data = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "Mr. Trash Wheel") %>% 
  janitor::clean_names() %>% 
  select(-x15) %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(sports_balls),
    as.integer(sports_balls)
  )

```

```{r precipitation}

prcpt2017_data = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "2017 Precipitation", skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na() %>% 
  mutate(
    year = "2017"
  )

prcpt2018_data = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "2018 Precipitation", skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na() %>% 
  mutate(
    year = "2018"
  )

prcpt_data =
  bind_rows(prcpt2017_data, prcpt2018_data) %>%
  mutate(
    month = month.abb[month]
  )
prcpt_data
```

In Mr. Trash Wheel data, we have `r nrow(trash_data)` observations, and we have key variables such as dumpster, month, year, and date. In resulting precipitation dataset which we obtained from combining precipitation data of 2017 and 2018, we have `r nrow(prcpt_data)` total precipitation observations in total and we have ey variables month and year. According to the precipitation dataset, the total precipitation in 2018 is `r sum(pull(prcpt2018_data, total))` inches and the median number of sports balls in a dumpster in 2017 is `r median(pull(filter(trash_data, year == 2017), sports_balls))`.

## Problem 2
* **Part 1**

In problem two, we are dealing with FiveThirtyEight data which is composed of different .csv files. First, I cleaned the data in pols_month.csv file. This data contains pieces of information about democratic/republican politicians. I started cleaning up by cleaning the names and then seperating date (originally "mon" variable) into year, month, and day variables and used convert = true to convert them to integers (these were characters). Then I made a new column named "president" which shows whether the president was republican or democrat. This column will essentially include information from prez_gop and prez_dem columns, so for doing this, I just recoded the information in prez_gop column. After creating the president variable, I no longer need prez_gop and prez_dem columns, so I just removed these variables as well as the variable day that was mentioned in the problem.

Note: I observed two "2" values in prez_gop while the values in this column should be either either 0 or 1. So Ijust assumed these values are supposed to be "1" and before recoding, to the president column, I replaced them with "1".

```{r prob2_pols_month}

pols_month_data = read_csv("data/pols-month.csv") %>% 
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), convert = TRUE) %>% 
  mutate(
    month = month.abb[(month)],
    prez_gop = replace(prez_gop, prez_gop == "2", "1"),
    president = recode(prez_gop, "1" = "gop" , "0" = "dem"),
  ) %>% 
   select(year, month, president, everything(), -starts_with("prez"), -day)

```

* **Part 2**

Second, I neede to clean the snp data. The process for this part is very similar to part 1 of this problem, but I also had to arrange year and month variables' order, and I did not select day because it I did not need that according to the problem. Then I turned month from numeric format to English names abbreviations.

```{r prob2_snp}

snp_data = read_csv("data/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("month", "day", "year"), convert = TRUE) %>%
  select(year, month, close) %>% 
  mutate(
    month = month.abb[(month)]
  )

```

```{r prob2_unemployment}

unemployment_data = read_csv("data/unemployment.csv") %>% 
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "unemp_prcnt"
  ) %>% 
    janitor::clean_names()                                      #can we use janitor here?

```

```{r join_datasets}

join_pols_snp = left_join(pols_month_data, snp_data, by = c("year", "month"))

join_all = left_join(join_pols_snp, unemployment_data, by = c("year", "month")) 

# could we use piping here?
# left vs full join
```


## Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

```{r prob3_cleaning}

pop_names_data = read_csv("data/Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    childs_first_name = str_to_title(childs_first_name),
    gender = str_to_lower(gender),
    ethnicity = replace(ethnicity, ethnicity == "ASIAN AND PACI" , "ASIAN AND PACIFIC ISLANDER"),
    ethnicity = replace(ethnicity, ethnicity == "WHITE NON HISP", "WHITE NON HISPANIC"),
    ethnicity = replace(ethnicity, ethnicity == "BLACK NON HISP", "BLACK NON HISPANIC")
  ) %>% 
  mutate(
    ethnicity = str_to_title(ethnicity)                  # should we make gender and ethnicity lower case?!
  )

pop_names_data = distinct(pop_names_data)

```

```{r prob3_Olivia_name}

olivia_pop = filter(pop_names_data, childs_first_name == "Olivia") %>% 
  select(year_of_birth, ethnicity, rank) %>% 
pivot_wider(
  names_from = "year_of_birth", 
  values_from = "rank")
```

```{r prob3_male_pop}

male_pop = filter(pop_names_data, gender == "male" & rank == "1") %>% 
    select(year_of_birth, ethnicity, childs_first_name) %>% 
pivot_wider(
  names_from = "year_of_birth", 
  values_from = "childs_first_name")
```

```{r prob3_scatterplot}

pop_scatterplot = pop_names_data %>% 
  filter(gender == "male" & ethnicity == "White Non Hispanic" & year_of_birth == "2016") %>% 
  ggplot(aes(x = rank, y = count)) + geom_point() + geom_text(aes(label = childs_first_name),hjust = 0, vjust = 0)

# what is this?!
```

